package scrapper

import (
	"github.com/gocolly/colly"
	_ "github.com/lib/pq"
	"github.com/umarrohman03/scrapping/internal/env"
	"time"
)

func NewScrapperClient(env *env.ENV) *colly.Collector {
	c := colly.NewCollector(
		//colly.Debugger(&debug.LogDebugger{}),
		colly.UserAgent(env.ScrapperUserAgent),
	)

	//todo move to env for header and timeout
	c.SetRequestTimeout(120 * time.Second)
	c.OnRequest(func(r *colly.Request) {
		r.Headers.Set("User-Agent", "PostmanRuntime/7.33.0")
		r.Headers.Set("cache-control", "no-cache")
		r.Headers.Set("Accept", "*/*")
		r.Headers.Set("Host", "www.tokopedia.com")
		r.Headers.Set("Accept-Encoding", "gzip, deflate, br")
		r.Headers.Set("Connection", "keep-alive")
		r.Headers.Set("Cookie", "bm_sz=FF7D3B9D1F42F26ADDE30D0AEF2BD3BE~YAAQ5i2pylpDIsuLAQAAxOVp6BVW0ZK563i+CXQ7iKNhIo+nRxshgzmM1LZvdCiimeepQodAKX5cZ9iE0G2Gc/O6Wes2pSRs86kdfS+tEXxNKk0wRk5BWNnj4Rl404/U+6aYEpEPSs3AhFEu/Dg2ZJN/5f5y9pCD81CK5UIwtskoV+pYYFha9N7DuqX3cPnVGE8HZHs4elXUgG+3tpM2xyjO73F71oyNoVie6ZR3JLvTRkuCr+Z/yMUl4LxVjy9x85j+se0ClNdVWvQW2EzCtxqUeUP0QlHJptn7fArsTiz3VBl57fs=~4534849~4277813; _gcl_au=1.1.160298797.1700411337; _UUID_NONLOGIN_=2fe55d985c1c91a24d958a0b05004aaf; hfv_banner=true; _gid=GA1.2.976923406.1700411337; _dc_gtm_UA-126956641-6=1; DID=5ae658c7eb121da4187b514b1ee27ea06bf8aa676b1284f5e2ee6ec4e5383d2e9a17e24c9e8fa1953ce2f5eb9d07f588; DID_JS=NWFlNjU4YzdlYjEyMWRhNDE4N2I1MTRiMWVlMjdlYTA2YmY4YWE2NzZiMTI4NGY1ZTJlZTZlYzRlNTM4M2QyZTlhMTdlMjRjOWU4ZmExOTUzY2UyZjVlYjlkMDdmNTg447DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=; _SID_Tokopedia_=eUjLd4qov2Jj1lvyg8tQ2g-6WKSTajeZe4o91ZZ_yh478fLEYqZgCqaNdiaTx-Y2awn-T1UNXS1bMoGEfFuSRnziIZw57Z8XQRSq7YaD3LG7j2mFqGVMY0CfbVZkz3Gb; _abck=4341649A2D5D8F5A79598602C81169BF~0~YAAQ5i2pymZDIsuLAQAAc+lp6Ar/60bH2AVKIXdJ9tJIS8jk5I+99TXshYJ4lGXbD7ARO8oM7Vg8A4j+ivKsGuipY89kAFaVEB1XZTEFnoHqdKdxqnBWL/f4iJlytpbcLQ2lwrL3ZSTKnTVxzayTIUb2OllLT+ZmYUB/lhLGGXAq7Ljy6X+AK9svPD74y4SiLuIQ4KMITDkzD0MWtVjDHoTqo5NsI+u8RFmeJPi7ocln7oyuOwtHAvvQBKXsQGmsRpU8civf7zC+MrVvNRO+seSOktr0Ptaj38tGjjWZEyR+u3SznqOw01qG/4Wsh07YbIk8Sh0dmFgQUKeJhVq+kuSsRh7psXHSchFD3WN1jc+U8Q2xH7wGqvVZ3jw8YI4QGwwElDNTW5G9ee4UWPyP/HuJnOhKoRXeT2Q9~-1~-1~-1; ak_bmsc=94B51304D969EF1DD01651B4E2D925F7~000000000000000000000000000000~YAAQ5i2pymdDIsuLAQAAzelp6BWpY5B5fEiVCTv1h3f7Pu1c+axtFGp+k+SYz6GnEIQyWK+fnDD2z09qOz+ou3do+khi2pXRfVUTso/H0u2JHO0xg15VtwM1SN8Qx+EHDB6ci0pWhI5cyA6AfFdGDUPU+qTwx0B9a7qhn3QEclRJqE5lK3qmM3kIihmVprQ1bnEwCMJGHytARBphR3vA7UTMNxQ2CQY0ehdHAVhbksvWXFUnDkhR0hyoAKHd3EuED4Pa/SnamnVl2mfVrvW6+ve0BiMoIn4WpAVrVzp5f0kG04m+QY3KN6w4LQxO+nPMqt1Wsgw1y7nZ9cl4gF6hYGRjEG0u8GfuNloVuB4aHNgIC7ydtcXc5QWOz2SqfNrtGJNDJ1DpEtMvniVFsVV3l+oY2C/kxulXvbSKHf/JOp27WTUc8icF5umROUxn620aOw4vwRYfMHMxTdc98eRgLgfL6jg9a1PeLGeTa1K3k37QXYGhwKZzbHsMMZZaRtJe4Q==; AMP_TOKEN=%24NOT_FOUND; _dc_gtm_UA-9801603-1=1; _UUID_CAS_=57c6d75c-982a-451d-aa0c-87186aab41a9; _CASE_=732a6c416c2a323a3a3f3c242a69416c2a3238242a646a642a322a426963697a7c6928587d7b697c2a242a6b416c2a32393f3e242a6467666f2a322a2a242a64697c2a322a2a242a784b672a322a2a242a7f416c2a32393a3a39383b3f3d242a7b416c2a3239393d3b383d3f3b242a7b5c71786d2a322a3a602a242a7f607b2a322a5373542a7f697a6d60677d7b6d57616c542a32393a3a39383b3f3d24542a7b6d7a7e616b6d577c71786d542a32542a3a60542a24542a57577c71786d6669656d542a32542a5f697a6d60677d7b6d7b542a752473542a7f697a6d60677d7b6d57616c542a323824542a7b6d7a7e616b6d577c71786d542a32542a393d65542a24542a57577c71786d6669656d542a32542a5f697a6d60677d7b6d7b542a75552a242a645d786c2a322a3a383a3b2539392539315c3a3b323a30323d3f23383f3238382a75; _fbp=fb.1.1700411341963.833537304; serverECT=4g; _gat_UA-9801603-1=1; _ga=GA1.2.89334158.1700411337; _ga_70947XW48P=GS1.1.1700411336.1.1.1700411345.51.0.0; ISID=%7B%22www.tokopedia.com%22%3A%22d3d3LnRva29wZWRpYS5jb20%3D.89c2c6e38cab64ca186f130d2c70d9e9.1700411336850.1700411336850.1700411346633.2%22%7D")
	})
	return c
}
